<!doctype html>
<html lang="zh-cn" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.2">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="LANTEN Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="LANTEN Blog Atom Feed">
<link rel="stylesheet" href="//at.alicdn.com/t/font_599565_s74s9c3vm6.css"><title data-react-helmet="true">关于 WEB 性能优化 | LANTEN</title><meta data-react-helmet="true" name="description" content="本文讨论的是前后端分离模式下前端网页的性能优化，追求更快的响应速度，更少的网络资源，内存资源，算力资源的消耗。我将目前了解的相关内容整理至此，尚未完善，随时补充。"><meta data-react-helmet="true" property="og:description" content="本文讨论的是前后端分离模式下前端网页的性能优化，追求更快的响应速度，更少的网络资源，内存资源，算力资源的消耗。我将目前了解的相关内容整理至此，尚未完善，随时补充。"><meta data-react-helmet="true" property="og:url" content="https://www.lanten.me/blog/web-performance-optimization"><meta data-react-helmet="true" name="docusaurus_locale" content="zh-cn"><meta data-react-helmet="true" name="docusaurus_tag" content="default"><meta data-react-helmet="true" property="og:title" content="关于 WEB 性能优化 | LANTEN"><meta data-react-helmet="true" name="keywords" content="前端,web,性能优化"><meta data-react-helmet="true" property="og:image" content="https://source.unsplash.com/user/lanten/likes?key=1"><meta data-react-helmet="true" name="twitter:image" content="https://source.unsplash.com/user/lanten/likes?key=1"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://www.lanten.me/blog/web-performance-optimization"><link data-react-helmet="true" rel="alternate" href="https://www.lanten.me/blog/web-performance-optimization" hreflang="zh-cn"><link data-react-helmet="true" rel="alternate" href="https://www.lanten.me/blog/web-performance-optimization" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.8c1ab9c2.css">
<link rel="preload" href="/assets/js/runtime~main.aa66a4f9.js" as="script">
<link rel="preload" href="/assets/js/main.e753ad49.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/avatar.jpg" alt="Lanten Avatar" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/avatar.jpg" alt="Lanten Avatar" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">Lanten</b></a><a class="navbar__item navbar__link" href="/docs/README">笔记</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">博客</a><a class="navbar__item navbar__link" href="/blog/tags">标签</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/lanten" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><i class="navbar__item navbar__link icon icon-github fs-18 pr-4 fade-link"></i>Github</a><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--checked react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">🌜</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">🌞</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" checked="" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="navbar__search searchBarContainer_MM2z"><input placeholder="搜索" aria-label="Search" class="navbar__search-input"><div class="loadingRing_s5VG searchBarLoadingRing_2jQk"><div></div><div></div><div></div><div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/avatar.jpg" alt="Lanten Avatar" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/avatar.jpg" alt="Lanten Avatar" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">Lanten</b></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/README">笔记</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/blog">博客</a></li><li class="menu__list-item"><a class="menu__link" href="/blog/tags">标签</a></li><li class="menu__list-item"><a href="https://github.com/lanten" target="_blank" rel="noopener noreferrer" class="menu__link"><i class="navbar__item navbar__link icon icon-github fs-18 pr-4 fade-link"></i>Github</a></li></ul></div></div></div></nav><div class="main-wrapper blog-wrapper blog-post-page" data-title="关于 WEB 性能优化"><img class="post-banner-image" src="https://source.unsplash.com/user/lanten/likes?key=1"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"></aside><main class="col col--7"><article class="post-content"><div class="list-card-content"><header class="post-header"><h1 class="blogPostTitle_nmLu">关于 WEB 性能优化</h1><div class="blogPostData_3WzT margin-vert--md"><time datetime="2021-05-05T00:00:00.000Z">2021年5月5日</time> · 2 分钟阅读</div><div class="avatar margin-vert--md"><div class="avatar__intro"></div></div></header><div class="markdown"><p>本文讨论的是前后端分离模式下前端网页的性能优化，追求更快的响应速度，更少的网络资源，内存资源，算力资源的消耗。我将目前了解的相关内容整理至此，尚未完善，随时补充。</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="dns-解析阶段"></a>DNS 解析阶段<a class="hash-link" href="#dns-解析阶段" title="Direct link to heading">#</a></h2><p><code>dns-prefetch</code> 可帮助开发人员降低 DNS 解析延迟。 HTML <code>&lt;link&gt;</code> 元素 通过 <code>dns-prefetch</code> 的 <code>rel</code> 属性值提供此功能。然后在 <code>href</code> 属性中指要跨域的域名, 例子：</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly html"><pre tabindex="0" class="prism-code language-html codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#282e3a"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token tag punctuation" style="color:#89ddff">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">html</span><span class="token tag punctuation" style="color:#89ddff">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token tag punctuation" style="color:#89ddff">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">head</span><span class="token tag punctuation" style="color:#89ddff">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token tag punctuation" style="color:#89ddff">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">link</span><span class="token tag" style="color:rgb(255, 85, 114)"> </span><span class="token tag attr-name" style="color:#ffcb6b">rel</span><span class="token tag attr-value punctuation attr-equals" style="color:#89ddff">=</span><span class="token tag attr-value punctuation" style="color:#89ddff">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">dns-prefetch</span><span class="token tag attr-value punctuation" style="color:#89ddff">&quot;</span><span class="token tag" style="color:rgb(255, 85, 114)"> </span><span class="token tag attr-name" style="color:#ffcb6b">href</span><span class="token tag attr-value punctuation attr-equals" style="color:#89ddff">=</span><span class="token tag attr-value punctuation" style="color:#89ddff">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">https://fonts.gstatic.com/</span><span class="token tag attr-value punctuation" style="color:#89ddff">&quot;</span><span class="token tag" style="color:rgb(255, 85, 114)"> </span><span class="token tag punctuation" style="color:#89ddff">/&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">&lt;!-- and all other head elements --&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token tag punctuation" style="color:#89ddff">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">head</span><span class="token tag punctuation" style="color:#89ddff">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token tag punctuation" style="color:#89ddff">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">body</span><span class="token tag punctuation" style="color:#89ddff">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">&lt;!-- your page content --&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token tag punctuation" style="color:#89ddff">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">body</span><span class="token tag punctuation" style="color:#89ddff">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token tag punctuation" style="color:#89ddff">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">html</span><span class="token tag punctuation" style="color:#89ddff">&gt;</span></span></code></pre><button type="button" aria-label="复制代码到剪辑版" class="copyButton_Ue-o clean-btn">Copy</button></div></div><div class="admonition admonition-caution alert alert--warning"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>注意</h5></div><div class="admonition-content"><p>虽然使用 <code>dns-prefetch</code> 能够加快页面的解析速度，但是也不能滥用，因为这会导致 DNS 解析次数飙升，对于按量计费的 DNS 服务来说，这意味着更高的经济成本。可以使用 <code>&lt;meta http-equiv=&quot;x-dns-prefetch-control&quot; content=&quot;off&quot;&gt;</code> 来禁止隐式的 <code>dns-prefetch</code></p></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="tcp、http-阶段"></a>TCP、HTTP 阶段<a class="hash-link" href="#tcp、http-阶段" title="Direct link to heading">#</a></h2><p>可以通过在服务端调整 TCP 相关报文参数来优化连接速度。此外 <code>TLS1.3</code> 可以简化握手流程，提升安全性的同时优化了响应速度。</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="静态资源服务器"></a>静态资源服务器<a class="hash-link" href="#静态资源服务器" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="实时无损压缩"></a>实时无损压缩<a class="hash-link" href="#实时无损压缩" title="Direct link to heading">#</a></h3><p>Nginx 模块 <code>ngx_http_gzip_module</code> 可以实现静态资源实时压缩，此模块是默认集成的。</p><div class="codeBlockContainer_K1bP"><div style="color:#bfc7d5;background-color:#282e3a" class="codeBlockTitle_eoMF">nginx.conf</div><div class="codeBlockContent_hGly conf"><pre tabindex="0" class="prism-code language-conf codeBlock_23N8 thin-scrollbar codeBlockWithTitle_2JqI" style="color:#bfc7d5;background-color:#282e3a"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">gzip on  # 开启 gzip</span></span></code></pre><button type="button" aria-label="复制代码到剪辑版" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="内容缓存"></a>内容缓存<a class="hash-link" href="#内容缓存" title="Direct link to heading">#</a></h3><p><code>proxy-cache</code> 可以将用户的请缓存到本地一个目录，当下一个请求时可以直接调取缓存文件，就不用去后端服务器去取文件了。</p><div class="codeBlockContainer_K1bP"><div style="color:#bfc7d5;background-color:#282e3a" class="codeBlockTitle_eoMF">nginx.conf</div><div class="codeBlockContent_hGly conf"><pre tabindex="0" class="prism-code language-conf codeBlock_23N8 thin-scrollbar codeBlockWithTitle_2JqI" style="color:#bfc7d5;background-color:#282e3a"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">location~ .*\.(gif|jpg|png|htm|html|css|js|flv|ico|swf)(.*) {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    proxy_pass http://appserver ;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    proxy_redirect off;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    proxy_set_header Host $host;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    proxy_cache cache_one;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    proxy_cache_valid 200 302 1h;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    proxy_cache_valid 301 1d;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    proxy_cache_valid any 1m;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    expires 30d;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="复制代码到剪辑版" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="浏览器渲染阶段"></a>浏览器渲染阶段<a class="hash-link" href="#浏览器渲染阶段" title="Direct link to heading">#</a></h2><p>浏览器在获得各种静态资源后，解析代码并渲染 DOM、运行 V8 进程。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="资源加载顺序"></a>资源加载顺序<a class="hash-link" href="#资源加载顺序" title="Direct link to heading">#</a></h3><p>通常情况下，将 css 资源放在 html 头部 <code>head</code>，优先加载样式，可以避免页面错乱。将 js 资源放在 <code>body</code> 最底部，以保证 js 文件过大时优先渲染出基本内容。</p><blockquote><p>这是 <code>jquery</code> 时代的技巧，在工程化模式下，依然适用。</p></blockquote><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="按需加载"></a>按需加载<a class="hash-link" href="#按需加载" title="Direct link to heading">#</a></h3><p>V8 引擎在解析 AST 抽象语法树时需要消耗大量时间，所以对于首屏加载速度来说，减少代码量是最有效的性能提升方法。</p><p>借助 <code>webpack</code> 等打包工具，将各路由下独立不共享的代码拆分打包到不同的文件中，在路由激活时请求加载当前路由需要用到的资源，是为按需加载，又称懒加载。</p><p>如果是外部资源，可以通过动态插入 <code>script</code> 标签的方式按需加载。<a href="/docs/代码片段/动态加载资源">查看示例代码(TS)</a></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="预加载"></a>预加载<a class="hash-link" href="#预加载" title="Direct link to heading">#</a></h3><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTML/Preloading_content" target="_blank" rel="noopener noreferrer">预加载</a>是一个声明性提取请求，要求浏览器尽快请求资源。通过在 HTML 的 <code>head</code> 中添加标记 <code>&lt;link&gt;</code> <code>rel=&quot;preload&quot;</code> 来预加载关键资源：</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly html"><pre tabindex="0" class="prism-code language-html codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#282e3a"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token tag punctuation" style="color:#89ddff">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">head</span><span class="token tag punctuation" style="color:#89ddff">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token tag punctuation" style="color:#89ddff">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">link</span><span class="token tag" style="color:rgb(255, 85, 114)"> </span><span class="token tag attr-name" style="color:#ffcb6b">rel</span><span class="token tag attr-value punctuation attr-equals" style="color:#89ddff">=</span><span class="token tag attr-value punctuation" style="color:#89ddff">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">preload</span><span class="token tag attr-value punctuation" style="color:#89ddff">&quot;</span><span class="token tag" style="color:rgb(255, 85, 114)"> </span><span class="token tag attr-name" style="color:#ffcb6b">href</span><span class="token tag attr-value punctuation attr-equals" style="color:#89ddff">=</span><span class="token tag attr-value punctuation" style="color:#89ddff">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">style.css</span><span class="token tag attr-value punctuation" style="color:#89ddff">&quot;</span><span class="token tag" style="color:rgb(255, 85, 114)"> </span><span class="token tag attr-name" style="color:#ffcb6b">as</span><span class="token tag attr-value punctuation attr-equals" style="color:#89ddff">=</span><span class="token tag attr-value punctuation" style="color:#89ddff">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">style</span><span class="token tag attr-value punctuation" style="color:#89ddff">&quot;</span><span class="token tag" style="color:rgb(255, 85, 114)"> </span><span class="token tag punctuation" style="color:#89ddff">/&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token tag punctuation" style="color:#89ddff">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">link</span><span class="token tag" style="color:rgb(255, 85, 114)"> </span><span class="token tag attr-name" style="color:#ffcb6b">rel</span><span class="token tag attr-value punctuation attr-equals" style="color:#89ddff">=</span><span class="token tag attr-value punctuation" style="color:#89ddff">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">preload</span><span class="token tag attr-value punctuation" style="color:#89ddff">&quot;</span><span class="token tag" style="color:rgb(255, 85, 114)"> </span><span class="token tag attr-name" style="color:#ffcb6b">href</span><span class="token tag attr-value punctuation attr-equals" style="color:#89ddff">=</span><span class="token tag attr-value punctuation" style="color:#89ddff">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">main.js</span><span class="token tag attr-value punctuation" style="color:#89ddff">&quot;</span><span class="token tag" style="color:rgb(255, 85, 114)"> </span><span class="token tag attr-name" style="color:#ffcb6b">as</span><span class="token tag attr-value punctuation attr-equals" style="color:#89ddff">=</span><span class="token tag attr-value punctuation" style="color:#89ddff">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">script</span><span class="token tag attr-value punctuation" style="color:#89ddff">&quot;</span><span class="token tag" style="color:rgb(255, 85, 114)"> </span><span class="token tag punctuation" style="color:#89ddff">/&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token tag punctuation" style="color:#89ddff">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">head</span><span class="token tag punctuation" style="color:#89ddff">&gt;</span></span></code></pre><button type="button" aria-label="复制代码到剪辑版" class="copyButton_Ue-o clean-btn">Copy</button></div></div><blockquote><p>预加载的 <code>href</code> 可以是 <code>js</code> , 文件在随后的页面渲染中，一旦需要使用它们，它们就会立即可用。<br>
结合 <a href="#%E6%8C%89%E9%9C%80%E5%8A%A0%E8%BD%BD">按需加载</a>，可以将与当前页面有关联的路由的相关联的资源放入预加载队列中。</p></blockquote><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="js-代码层面"></a>JS 代码层面<a class="hash-link" href="#js-代码层面" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="算法"></a>算法<a class="hash-link" href="#算法" title="Direct link to heading">#</a></h3><p>没有什么比高效能的算法更能优化性能的了。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="事件委托"></a>事件委托<a class="hash-link" href="#事件委托" title="Direct link to heading">#</a></h3><p>又称事件代理，指通过事件冒泡，只指定一个事件处理程序，就可以管理某一类型的所有事件。</p><div class="codeBlockContainer_K1bP"><div style="color:#bfc7d5;background-color:#282e3a" class="codeBlockTitle_eoMF">示例</div><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar codeBlockWithTitle_2JqI" style="color:#bfc7d5;background-color:#282e3a"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">element</span><span class="token punctuation" style="color:#89ddff">.</span><span class="token method function property-access" style="color:#82aaff">addEventListener</span><span class="token punctuation" style="color:#89ddff">(</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;click&#x27;</span><span class="token punctuation" style="color:#89ddff">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:#89ddff">(</span><span class="token parameter">e</span><span class="token punctuation" style="color:#89ddff">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#89ddff">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#c792ea;font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#89ddff">(</span><span class="token plain">e</span><span class="token punctuation" style="color:#89ddff">.</span><span class="token property-access">target</span><span class="token punctuation" style="color:#89ddff">.</span><span class="token property-access">tagName</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">===</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;P&#x27;</span><span class="token punctuation" style="color:#89ddff">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#89ddff">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token function" style="color:#82aaff">alert</span><span class="token punctuation" style="color:#89ddff">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;ok&#x27;</span><span class="token punctuation" style="color:#89ddff">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:#89ddff">}</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:#89ddff">}</span><span class="token punctuation" style="color:#89ddff">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:#89ddff">)</span></span></code></pre><button type="button" aria-label="复制代码到剪辑版" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>以上代码实现在 <code>element</code> 的所有子元素中的 <code>p</code> 标签上点击，都会弹出 <code>ok</code>。</p><ul><li>事件委托本身在运行时性能消耗上无影响 <a href="/docs/Javascript/事件委托的性能影响">怎么说</a></li><li>在一些 <code>MVC</code> 框架中涉及到频繁的重渲染时，事件委托具有很大优势</li><li>在数据量较大时，使用事件委托可以节约内存占用</li><li>对于 <code>Chromium</code> 内核的现代浏览器来说，在数据量小（小于 <code>1000</code> 条）时没有必要使用事件委托</li><li>缺点：层级复杂的元素代理繁琐，容易误判</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="立即执行函数"></a>立即执行函数<a class="hash-link" href="#立即执行函数" title="Direct link to heading">#</a></h3><p>对于立即执行函数来说, 括号方案比其他方案具有更好的性能优势</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#282e3a"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:#89ddff">;</span><span class="token punctuation" style="color:#89ddff">(</span><span class="token keyword" style="color:#c792ea;font-style:italic">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#89ddff">(</span><span class="token punctuation" style="color:#89ddff">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#89ddff">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token console class-name" style="color:#ffcb6b">console</span><span class="token punctuation" style="color:#89ddff">.</span><span class="token method function property-access" style="color:#82aaff">log</span><span class="token punctuation" style="color:#89ddff">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;Hello, World!&#x27;</span><span class="token punctuation" style="color:#89ddff">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:#89ddff">}</span><span class="token punctuation" style="color:#89ddff">)</span><span class="token punctuation" style="color:#89ddff">(</span><span class="token punctuation" style="color:#89ddff">)</span></span></code></pre><button type="button" aria-label="复制代码到剪辑版" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>以上代码会在 AST 分析阶段立即解析<br>
使用括号封装函数。对于解析器来说，这几乎总是一个积极的信号，即函数需要立即执行。如果解析器看到一个左括号，紧接着是一个函数声明，它将立即解析这个函数</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#282e3a"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 这个函数完全可以优化成立即执行函数的形式。</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="color:#c792ea;font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:#82aaff">foo</span><span class="token punctuation" style="color:#89ddff">(</span><span class="token punctuation" style="color:#89ddff">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#89ddff">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token console class-name" style="color:#ffcb6b">console</span><span class="token punctuation" style="color:#89ddff">.</span><span class="token method function property-access" style="color:#82aaff">log</span><span class="token punctuation" style="color:#89ddff">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;Hello, World!&#x27;</span><span class="token punctuation" style="color:#89ddff">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:#89ddff">}</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:#82aaff">foo</span><span class="token punctuation" style="color:#89ddff">(</span><span class="token punctuation" style="color:#89ddff">)</span></span></code></pre><button type="button" aria-label="复制代码到剪辑版" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>以上代码不会在 AST 分析阶段立即解析, 先执行懒解析, 然后在执行立即解析, 这和立即解析相比，运行速度会慢 50%。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="节流与防抖"></a>节流与防抖<a class="hash-link" href="#节流与防抖" title="Direct link to heading">#</a></h3><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="react-相关优化"></a>React 相关优化<a class="hash-link" href="#react-相关优化" title="Direct link to heading">#</a></h2><ul><li>使用 <code>shouldComponentUpdate</code> 通知 React 当前组件是否需要参与 Diff (component diff 环节)</li><li>继承 <code>React.PureComponent</code> (纯组件) 通过 <code>props</code> 和 <code>states</code> 的浅对比来自动实现 <code>shouldComponentUpate()</code>, 其他特征与 <code>React.Component</code> 表现一致。此外, 可以通过高阶函数 <code>React.memo</code> (React16.6 新增) 将函数式组件包装为纯组件</li><li>由于 tree diff 算法特性, Virtual DOM 层级结构变化会重新创建对应节点, 所以保持稳定的 DOM 结构会有助于性能的提升。例如，可以通过 CSS 隐藏或显示节点，而不是移除或添加 DOM 节点。</li><li>尽可能避免 DOM 类型变更, component diff 算法会将类型改变的 DOM 重新创建</li><li>为统一层级不同节点添加静态 <code>key</code> 以优化个别元素的添加/删除/移动操作</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="vue-相关优化"></a>Vue 相关优化<a class="hash-link" href="#vue-相关优化" title="Direct link to heading">#</a></h2><ul><li>其 diff 算法与 React 类似，相关优化方案可以适用。</li><li>TODO...</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="参考"></a>参考<a class="hash-link" href="#参考" title="Direct link to heading">#</a></h2><ul><li><a href="https://blog.sessionstack.com/how-javascript-works-parsing-abstract-syntax-trees-asts-5-tips-on-how-to-minimize-parse-time-abfcf7e8a0c8" target="_blank" rel="noopener noreferrer">https://blog.sessionstack.com/how-javascript-works-parsing-abstract-syntax-trees-asts-5-tips-on-how-to-minimize-parse-time-abfcf7e8a0c8</a></li><li><a href="https://web.dev/apply-instant-loading-with-prpl/" target="_blank" rel="noopener noreferrer">https://web.dev/apply-instant-loading-with-prpl/</a></li></ul></div><footer class="row mt-24 blogPostDetailsFull_3bEF"><div class="col"><b>标签:</b><a class="margin-horiz--sm" href="/blog/tags/前端">前端</a><a class="margin-horiz--sm" href="/blog/tags/web">web</a><a class="margin-horiz--sm" href="/blog/tags/性能优化">性能优化</a></div></footer></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/blog/typescript-advanced"><div class="pagination-nav__sublabel">上一篇</div><div class="pagination-nav__label">« Typescript - 进阶篇</div></a></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav><div id="gitalk-container" class="mt-24"></div></main><div class="col col--2"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#dns-解析阶段" class="table-of-contents__link">DNS 解析阶段</a></li><li><a href="#tcp、http-阶段" class="table-of-contents__link">TCP、HTTP 阶段</a></li><li><a href="#静态资源服务器" class="table-of-contents__link">静态资源服务器</a><ul><li><a href="#实时无损压缩" class="table-of-contents__link">实时无损压缩</a></li><li><a href="#内容缓存" class="table-of-contents__link">内容缓存</a></li></ul></li><li><a href="#浏览器渲染阶段" class="table-of-contents__link">浏览器渲染阶段</a><ul><li><a href="#资源加载顺序" class="table-of-contents__link">资源加载顺序</a></li><li><a href="#按需加载" class="table-of-contents__link">按需加载</a></li><li><a href="#预加载" class="table-of-contents__link">预加载</a></li></ul></li><li><a href="#js-代码层面" class="table-of-contents__link">JS 代码层面</a><ul><li><a href="#算法" class="table-of-contents__link">算法</a></li><li><a href="#事件委托" class="table-of-contents__link">事件委托</a></li><li><a href="#立即执行函数" class="table-of-contents__link">立即执行函数</a></li><li><a href="#节流与防抖" class="table-of-contents__link">节流与防抖</a></li></ul></li><li><a href="#react-相关优化" class="table-of-contents__link">React 相关优化</a></li><li><a href="#vue-相关优化" class="table-of-contents__link">Vue 相关优化</a></li><li><a href="#参考" class="table-of-contents__link">参考</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">导航</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/README">笔记</a></li><li class="footer__item"><a class="footer__link-item" href="/blog">博客</a></li></ul></div><div class="col footer__col"><div class="footer__title">订阅</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" target="_blank" href="/blog/rss.xml">RSS</a></li><li class="footer__item"><a class="footer__link-item" target="_blank" href="/blog/atom.xml">Atom</a></li></ul></div><div class="col footer__col"><div class="footer__title">许可</div><ul class="footer__items"><li class="footer__item"><a href="https://creativecommons.org/licenses/by-nc-sa/3.0/cn/" target="_blank" rel="noopener noreferrer" class="icon icon-cc footer__link-item"> BY-NC-SA 3.0 CN</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 <a href="https://github.com/lanten" target="_blank">Lanten</a>. Built with <a href="https://docusaurus.io/" target="_blank">Docusaurus</a>.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.aa66a4f9.js"></script>
<script src="/assets/js/main.e753ad49.js"></script>
</body>
</html>